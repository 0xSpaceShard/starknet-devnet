"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[536],{2012:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>o});var s=r(4848),t=r(8453);const c={},i="Metrics",l={id:"metrics",title:"Metrics",description:"Starknet Devnet can expose Prometheus-compatible metrics for monitoring and observability. This feature allows you to track RPC calls, block creation, transactions, and upstream forking calls.",source:"@site/versioned_docs/version-0.7.2/metrics.md",sourceDirName:".",slug:"/metrics",permalink:"/starknet-devnet/docs/metrics",draft:!1,unlisted:!1,editUrl:"https://github.com/0xSpaceShard/starknet-devnet/blob/master/website/versioned_docs/version-0.7.2/metrics.md",tags:[],version:"0.7.2",frontMatter:{},sidebar:"docSidebar",previous:{title:"Lite mode",permalink:"/starknet-devnet/docs/lite"},next:{title:"L1-L2 interaction via Postman",permalink:"/starknet-devnet/docs/postman"}},a={},o=[{value:"Enabling Metrics",id:"enabling-metrics",level:2},{value:"Accessing Metrics",id:"accessing-metrics",level:2},{value:"Available Metrics",id:"available-metrics",level:2},{value:"RPC Metrics",id:"rpc-metrics",level:3},{value:"<code>rpc_call_duration_seconds</code>",id:"rpc_call_duration_seconds",level:4},{value:"<code>rpc_call_count</code>",id:"rpc_call_count",level:4},{value:"Starknet Core Metrics",id:"starknet-core-metrics",level:3},{value:"<code>starknet_transaction_count</code>",id:"starknet_transaction_count",level:4},{value:"<code>starknet_block_count</code>",id:"starknet_block_count",level:4},{value:"<code>starknet_block_creation_duration_seconds</code>",id:"starknet_block_creation_duration_seconds",level:4},{value:"Upstream Forking Metrics",id:"upstream-forking-metrics",level:3},{value:"<code>starknet_upstream_call_duration_seconds</code>",id:"starknet_upstream_call_duration_seconds",level:4},{value:"<code>starknet_upstream_call_count</code>",id:"starknet_upstream_call_count",level:4},{value:"Integrating with Prometheus",id:"integrating-with-prometheus",level:2},{value:"Example Queries",id:"example-queries",level:2},{value:"Average RPC call duration by method",id:"average-rpc-call-duration-by-method",level:3},{value:"RPC call rate by method",id:"rpc-call-rate-by-method",level:3},{value:"RPC error rate",id:"rpc-error-rate",level:3},{value:"Block creation rate",id:"block-creation-rate",level:3},{value:"Transaction throughput",id:"transaction-throughput",level:3},{value:"Upstream call error rate (forking mode)",id:"upstream-call-error-rate-forking-mode",level:3},{value:"95th percentile block creation time",id:"95th-percentile-block-creation-time",level:3},{value:"Visualization with Grafana",id:"visualization-with-grafana",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"metrics",children:"Metrics"}),"\n",(0,s.jsx)(n.p,{children:"Starknet Devnet can expose Prometheus-compatible metrics for monitoring and observability. This feature allows you to track RPC calls, block creation, transactions, and upstream forking calls."}),"\n",(0,s.jsx)(n.h2,{id:"enabling-metrics",children:"Enabling Metrics"}),"\n",(0,s.jsxs)(n.p,{children:["To enable metrics, start Devnet with the ",(0,s.jsx)(n.code,{children:"--metrics-host"})," parameter:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ starknet-devnet --metrics-host <IP_ADDRESS>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["By default, the metrics server will listen on port ",(0,s.jsx)(n.code,{children:"9090"}),". You can customize the port with the ",(0,s.jsx)(n.code,{children:"--metrics-port"})," parameter:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ starknet-devnet --metrics-host 127.0.0.1 --metrics-port 8080\n"})}),"\n",(0,s.jsx)(n.p,{children:"Or using environment variables:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ METRICS_HOST=127.0.0.1 METRICS_PORT=8080 starknet-devnet\n"})}),"\n",(0,s.jsx)(n.p,{children:"If running with Docker:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ docker run -e METRICS_HOST=0.0.0.0 -e METRICS_PORT=9090 -p 9090:9090 shardlabs/starknet-devnet-rs\n"})}),"\n",(0,s.jsx)(n.h2,{id:"accessing-metrics",children:"Accessing Metrics"}),"\n",(0,s.jsx)(n.p,{children:"Once the metrics server is running, you can access the metrics endpoint at:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http://<metrics-host>:<metrics-port>/metrics\n"})}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ curl http://127.0.0.1:9090/metrics\n"})}),"\n",(0,s.jsx)(n.p,{children:"The metrics are exposed in Prometheus text format, which can be scraped by Prometheus or other compatible monitoring systems."}),"\n",(0,s.jsx)(n.h2,{id:"available-metrics",children:"Available Metrics"}),"\n",(0,s.jsx)(n.h3,{id:"rpc-metrics",children:"RPC Metrics"}),"\n",(0,s.jsx)(n.h4,{id:"rpc_call_duration_seconds",children:(0,s.jsx)(n.code,{children:"rpc_call_duration_seconds"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Histogram"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Duration of RPC calls in seconds"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Labels:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"method"}),": The RPC method name (e.g., ",(0,s.jsx)(n.code,{children:"starknet_getBlockWithTxs"}),", ",(0,s.jsx)(n.code,{children:"starknet_call"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Buckets:"})," 0.00005, 0.0001, 0.00025, 0.0005, 0.001, 0.0025, 0.005, 0.01, 0.015, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0 seconds"]}),"\n",(0,s.jsx)(n.h4,{id:"rpc_call_count",children:(0,s.jsx)(n.code,{children:"rpc_call_count"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Counter"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Total number of RPC calls"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Labels:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"method"}),": The RPC method name"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"status"}),": Either ",(0,s.jsx)(n.code,{children:"success"})," or ",(0,s.jsx)(n.code,{children:"error"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"starknet-core-metrics",children:"Starknet Core Metrics"}),"\n",(0,s.jsx)(n.h4,{id:"starknet_transaction_count",children:(0,s.jsx)(n.code,{children:"starknet_transaction_count"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Counter"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Total number of transactions in Starknet"]}),"\n",(0,s.jsx)(n.p,{children:"This counter is incremented when a transaction is added to the network and decremented when blocks are aborted."}),"\n",(0,s.jsx)(n.h4,{id:"starknet_block_count",children:(0,s.jsx)(n.code,{children:"starknet_block_count"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Counter"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Total number of blocks in Starknet"]}),"\n",(0,s.jsx)(n.p,{children:"This counter is incremented when a new block is created and decremented when blocks are aborted."}),"\n",(0,s.jsx)(n.h4,{id:"starknet_block_creation_duration_seconds",children:(0,s.jsx)(n.code,{children:"starknet_block_creation_duration_seconds"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Histogram"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Duration of block creation in seconds"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Buckets:"})," 0.00005, 0.0001, 0.00025, 0.0005, 0.001, 0.0025, 0.005, 0.01 seconds"]}),"\n",(0,s.jsx)(n.p,{children:"This metric tracks how long it takes to generate a new block and transition from the pre-confirmed state."}),"\n",(0,s.jsx)(n.h3,{id:"upstream-forking-metrics",children:"Upstream Forking Metrics"}),"\n",(0,s.jsxs)(n.p,{children:["These metrics are only relevant when running Devnet in ",(0,s.jsx)(n.a,{href:"/starknet-devnet/docs/forking",children:"forking mode"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"starknet_upstream_call_duration_seconds",children:(0,s.jsx)(n.code,{children:"starknet_upstream_call_duration_seconds"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Histogram"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Duration of upstream forking origin calls in seconds"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Labels:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"method"}),": The RPC method called on the upstream network"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"status"}),": Either ",(0,s.jsx)(n.code,{children:"success"})," or ",(0,s.jsx)(n.code,{children:"error"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Buckets:"})," 0.001, 0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0 seconds"]}),"\n",(0,s.jsx)(n.h4,{id:"starknet_upstream_call_count",children:(0,s.jsx)(n.code,{children:"starknet_upstream_call_count"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type:"})," Counter"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Total number of upstream forking origin calls"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Labels:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"method"}),": The RPC method called on the upstream network"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"status"}),": Either ",(0,s.jsx)(n.code,{children:"success"})," or ",(0,s.jsx)(n.code,{children:"error"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These metrics help monitor the performance and reliability of interactions with the forked network."}),"\n",(0,s.jsx)(n.h2,{id:"integrating-with-prometheus",children:"Integrating with Prometheus"}),"\n",(0,s.jsxs)(n.p,{children:["To scrape these metrics with Prometheus, add the following job to your ",(0,s.jsx)(n.code,{children:"prometheus.yml"})," configuration:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"scrape_configs:\n  - job_name: 'starknet-devnet'\n    static_configs:\n      - targets: ['localhost:9090']\n"})}),"\n",(0,s.jsx)(n.p,{children:"Adjust the target address to match your Devnet metrics server configuration."}),"\n",(0,s.jsx)(n.h2,{id:"example-queries",children:"Example Queries"}),"\n",(0,s.jsx)(n.p,{children:"Here are some example PromQL queries you can use:"}),"\n",(0,s.jsx)(n.h3,{id:"average-rpc-call-duration-by-method",children:"Average RPC call duration by method"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:"rate(rpc_call_duration_seconds_sum[5m]) / rate(rpc_call_duration_seconds_count[5m])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rpc-call-rate-by-method",children:"RPC call rate by method"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:"rate(rpc_call_count[5m])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rpc-error-rate",children:"RPC error rate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:'rate(rpc_call_count{status="error"}[5m]) / rate(rpc_call_count[5m])\n'})}),"\n",(0,s.jsx)(n.h3,{id:"block-creation-rate",children:"Block creation rate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:"rate(starknet_block_count[5m])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"transaction-throughput",children:"Transaction throughput"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:"rate(starknet_transaction_count[5m])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"upstream-call-error-rate-forking-mode",children:"Upstream call error rate (forking mode)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:'rate(starknet_upstream_call_count{status="error"}[5m]) / rate(starknet_upstream_call_count[5m])\n'})}),"\n",(0,s.jsx)(n.h3,{id:"95th-percentile-block-creation-time",children:"95th percentile block creation time"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:"histogram_quantile(0.95, rate(starknet_block_creation_duration_seconds_bucket[5m]))\n"})}),"\n",(0,s.jsx)(n.h2,{id:"visualization-with-grafana",children:"Visualization with Grafana"}),"\n",(0,s.jsx)(n.p,{children:"You can visualize these metrics using Grafana by:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Adding Prometheus as a data source"}),"\n",(0,s.jsx)(n.li,{children:"Creating dashboards with panels using the PromQL queries above"}),"\n",(0,s.jsx)(n.li,{children:"Setting up alerts based on metric thresholds"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(6540);const t={},c=s.createContext(t);function i(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);