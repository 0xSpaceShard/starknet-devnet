"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7051],{240:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var o=t(4848),i=t(8453);const a={},s="Account impersonation",r={id:"account-impersonation",title:"Account impersonation",description:"This page is about account impersonation. To read about account class selection and deployment, click here.",source:"@site/versioned_docs/version-0.5.0-rc.0/account-impersonation.md",sourceDirName:".",slug:"/account-impersonation",permalink:"/starknet-devnet/docs/account-impersonation",draft:!1,unlisted:!1,editUrl:"https://github.com/0xSpaceShard/starknet-devnet/blob/master/website/versioned_docs/version-0.5.0-rc.0/account-impersonation.md",tags:[],version:"0.5.0-rc.0",frontMatter:{},sidebar:"docSidebar",previous:{title:"API",permalink:"/starknet-devnet/docs/api"},next:{title:"Account balance",permalink:"/starknet-devnet/docs/balance"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Tips",id:"tips",level:2},{value:"API",id:"api",level:2},{value:"devnet_impersonateAccount",id:"devnet_impersonateaccount",level:3},{value:"devnet_stopImpersonateAccount",id:"devnet_stopimpersonateaccount",level:3},{value:"devnet_autoImpersonate",id:"devnet_autoimpersonate",level:3},{value:"devnet_stopAutoImpersonate",id:"devnet_stopautoimpersonate",level:3},{value:"Preventing impersonation",id:"preventing-impersonation",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"account-impersonation",children:"Account impersonation"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["This page is about account impersonation. To read about account class selection and deployment, click ",(0,o.jsx)(n.a,{href:"./predeployed",children:"here"}),"."]})}),"\n",(0,o.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsx)(n.p,{children:"Devnet allows you to impersonate an account that exists on the Starknet mainnet or testnet. This is achieved by skipping the validation step of transactions for all or some accounts, on a running Devnet via JSON-RPC."}),"\n",(0,o.jsxs)(n.p,{children:["A transaction sent from an impersonated account will not fail with an invalid signature error, which is what happens in the general case of locally absent accounts. For impersonation to work, Devnet needs to ",(0,o.jsx)(n.a,{href:"/starknet-devnet/docs/forking",children:"fork"})," the network that has the desired account."]}),"\n",(0,o.jsx)(n.admonition,{title:"Caveat",type:"warning",children:(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Only ",(0,o.jsx)(n.code,{children:"INVOKE"})," and ",(0,o.jsx)(n.code,{children:"DECLARE"})," transactions are supported. ",(0,o.jsx)(n.code,{children:"DEPLOY_ACCOUNT"})," transaction is not supported, but you can create an ",(0,o.jsx)(n.code,{children:"INVOKE"})," transaction to UDC."]}),"\n",(0,o.jsx)(n.li,{children:"Due to the validation step being skipped, the overall fee of transactions sent with an impersonated account will be lower than regular transactions."}),"\n",(0,o.jsxs)(n.li,{children:["Trying to send a transaction with an account that ",(0,o.jsx)(n.strong,{children:"does not"})," even exist in the origin network returns an error:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ContractNotFound"})," if, during transaction preparation, you do not specify a nonce value, leading to the implicit querying of Devnet for the nonce."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"InsufficientAccountBalance"})," or similar if the nonce is supplied in the transaction; this happens because the token balance of a non-existent contract is 0 indeed insufficient."]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,o.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The impersonated account may have had all or a part of its funds used up on the origin network. You may need to give it more funds via ",(0,o.jsx)(n.a,{href:"/starknet-devnet/docs/balance",children:"minting"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"If you're defining a new account in your Starknet client application (starknet.js, starknet.rs, starkli...), you may need to specify a private key for it. Since the signature validation is skipped, you may provide a dummy key."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,o.jsx)(n.p,{children:"Account impersonation follows JSON-RPC method specification. Each method returns an empty response:"}),"\n",(0,o.jsx)(n.h3,{id:"devnet_impersonateaccount",children:"devnet_impersonateAccount"}),"\n",(0,o.jsx)(n.p,{children:"Impersonates a specific account address nonexistent in the local state."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'{\n    "jsonrpc": "2.0",\n    "id": "1",\n    "method": "devnet_impersonateAccount",\n    "params": {\n        "account_address": "0x49D36570D4E46F48E99674BD3FCC84644DDD6B96F7C741B1562B82F9E004DC7"\n    }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"devnet_stopimpersonateaccount",children:"devnet_stopImpersonateAccount"}),"\n",(0,o.jsx)(n.p,{children:"Stops the impersonation of an account previously marked for impersonation."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'{\n    "jsonrpc": "2.0",\n    "id": "1",\n    "method": "devnet_stopImpersonateAccount",\n    "params": {\n        "account_address": "0x49D36570D4E46F48E99674BD3FCC84644DDD6B96F7C741B1562B82F9E004DC7"\n    }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"devnet_autoimpersonate",children:"devnet_autoImpersonate"}),"\n",(0,o.jsx)(n.p,{children:"Enables automatic account impersonation. Every account that does not exist in the local state will be impersonated."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'{\n    "jsonrpc": "2.0",\n    "id": "1",\n    "method": "devnet_autoImpersonate",\n    "params": {}\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"devnet_stopautoimpersonate",children:"devnet_stopAutoImpersonate"}),"\n",(0,o.jsxs)(n.p,{children:["Stops the effect of ",(0,o.jsx)(n.a,{href:"#devnet_autoimpersonate",children:"automatic impersonation"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'{\n    "jsonrpc": "2.0",\n    "id": "1",\n    "method": "devnet_stopAutoImpersonate",\n    "params": {}\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"preventing-impersonation",children:"Preventing impersonation"}),"\n",(0,o.jsxs)(n.p,{children:["If you want to learn about completely preventing impersonation from being activated on your Devnet, click ",(0,o.jsx)(n.a,{href:"/starknet-devnet/docs/restrictive",children:"here"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var o=t(6540);const i={},a=o.createContext(i);function s(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);